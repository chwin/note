# vim

## 使用技巧

    C-[     # 可以代替 esc

## 移动

### 上、下、左、右

    k # 上
    j # 下
    h # 左
    l # 右

### 行内移动

    w  # 跳转到下一个单词的开头
    e  # 跳转到下一个单词的结尾
    b  # 跳转到上一个单词的开头
    fx # 往右移动到 x 字符上
    Fx # 往左移动到 x 字符上
    tx # 往右移动到 x 字符前
    Tx # 往左移动到 x 字符后
    ;  # 配合 f 和 t 使用，重复一次
    ,  # 配合 f 和 t 使用，反方向重复一次
    ^  # 跳转到当前行的第一个非空字符（空格 /tab)
    $  # 跳转到当前行的末尾
    0  # 跳转到当前行首

### 行数移动

    gg    # 跳转到文件第一行 (goto)
    G     # 跳转到文件最后一行
    -     # 移动到上一行首
    enter # 移动到下一行首

### 文本块移动

    %   # 括号匹配及切换
    ``  # 来回跳转
    `.  # 跳到最后修改点
    g;  # 跳到上一次修改点
    g,  # 跳到下一次修改点
    `   # 跳转到某标签的光标位置
    '   # 跳转到某标签的行首
    ma  # 在当前光标位置设置标签 a 标记
    `a  # 跳转到 a 标记
    C-o # 跳回上一次的 jump
    C-i # 跳回下一次的 jump
    C-] # 跟着 link/tag 转入 (follow link/tag)
    (   # 跳转到上一个句子的开头
    )   # 跳转到下一个句子的开头
    {   # 跳转到上一个段落的开头
    }   # 跳转到下一个段落的开头

    以上句字和段落操作可用于删除，例如 d + ( 可删除一句话
    同时也可以用 v 键选取一个句字或一个段落

### 屏幕移动

    C-f # 往前滚动一整屏 forward
    C-b # 往后滚动一整屏 back
    C-d # 往前滚动半屏 down
    C-u # 往后滚动半屏 up
    C-y # 往前滚动一行
    C-e # 往后滚动一行
    H   # 跳转到屏幕的顶部 (head)
    M   # 跳转到屏幕的中间 (middle)
    L   # 跳转到屏幕的底部 (low)
    zt  # 将当前行滚动至屏幕顶部 (top)
    zz  # 将当前行滚动至屏幕中间（同'z.')
    zb  # 将当前行滚动至屏幕底部 (bottom)（同'z-')

## 插入

    i   # 在光标位置前进入插入模式
    I   # 在当前行的第一个非空字符进入插入模式
    a   # 在光标位置后进入插入模式
    A   # 在当前行的末尾进入插入模式
    o   # 在当前行的下一行添加一个空行进入插入模式
    O   # 在当前行的上一行添加一个空行进入插入模式
    C-w # 删除光标前的一个单词（插入模式）
    C-u # 从光标位置删除到行首（插入模式）
    C-y # 复制上一行内容（插入模式）
    C-e # 复制下一行内容（插入模式）
    C-n # 使用关键词自动完成（插入模式）
    C-p # 使用关键词自动完成（插入模式）

    #连续插入#
    例如：########## 连续 10 个星号
    要实现这个效果可以在 命令模式 下

    输入 10，表示要重复 10 次
    输入 i 进入 编辑模式
    输入 # 也就是重复的文字
    按下 ESC 返回到 命令模式，返回之后 vi 就会把第 2、3 两步的操作重复 10 次

## 删除

    x       # 向后删除一个字符 （相当于 [del] 按键）
    xp      # 交换两个字符位置
    X       # 向前删除一个字符（相当于 [backspace] 亦即是退格键）
    d       # 删除
    ddp     # 交换行
    D       # 删除光标位置到行尾（等同于 d$)
    d/chwin # 配合使用查找 / 删除到 chwin 处
    dd      # 删除当前行
    dj      # 向下删一行
    dk      # 向上删一行
    dgg     # 删除光标所在到第一行的所有数据
    dG      # 删除光标所在到最后一行的所有数据
    dw      # 删当前字符到单词尾（包括空格） 3dw  (delete word)
    de      # 删当前字符到单词尾（不包括空格） 3de
    db      # 删除到某个单词的开始位置
    d2fa    # 删除光标到第二个字母 a
    d/chwin # 配合使用查找 / 删除到 chwin 处
    dtc     # 删除当前行直到下一个字符"c"所出现位置之间的内容
    :5,10d  # 删除 5-10 行
    d0      # 删除到行首
    d^      # 删除到行的第一个非空字符（空格 /tab)
    d)      # 删除从光标位置到下一个句子的开始
    d}      # 删除从光标位置到该段落的末尾
    diw     # 删除一个单词
    di{     # 删除花括号之间的内容 (delete inner {})（同'dib')
    di(     # 删除小括号之间的内容 (delete inner ())（同'dib')
    dit     # 删除闭合标签之间的内容 (html/xml 等标签，delete inner tag)
    dat     # 删除左右尖括号及之间的内容 (delete a tag)
    da<     # 删除左右尖括号及之间的内容 (delete a <>)
    di"     # 删除引号之间的内容 (delete inner "")
    da"     # 删除左右引号及之间的内容 (delete a "")
    daw     # 删除一个单词 (delete a word)
    d}      # 从光标位置删除到段落结尾
    ndd     # 从光标位置向下连续删除 n 行
    d代码行G # 从光标所在行 删除到 指定代码行 之间的所有代码
    d'a     # 从光标所在行 删除到 标记a 之间的所有代码

## 修改

    s        # 删除当前字符进入插入模式
    S        # 删除当前行进入插入模式
    r        # 替换单个字符
    R        # 替换多个字符
    c        # 修改选中区域里的文本
    C        # 修改光标到行尾
    cc       # 修改整行
    cl       # 修改当前字符
    cf[char] # 修改光标位置到 [char]
    ct[char] # 修改光标位置到 [char] 前
    ce       # 删除光标之后的一个单词
    cw       # 修改到某个以空格作为分隔符的单词的结尾位置
    cb       # 修改到某个单词的开始位置
    cb       # 修改到某个以空格作为分隔符的单词的开始位置
    c0       # 修改到行首
    c^       # 修改到行首非空格位置
    c)       # 修改到某个语句的结尾位置
    c(       # 修改到某个语句的开始位置
    c}       # 修改到某个段落的结尾位置
    c{       # 修改到某个段落的开始位置

### 行操作

    C-j  # 加入新行
    J    # 合并行
    5J   # 合并 5 行
    3,9J # 合并 3-9 行

### 大小写转换

    ~    # 切换光标下字符的大小写
    v ~  # 切换选定的文本大小写（可视模式）
    u    # 更改选定的文本为小写（可视模式）
    U    # 更改选定的文本为大写（可视模式）
    guw  # 将光标所在的单词变为小写
    gUw  # 将光标所在的单词变为大写
    guu  # 光标所在的行所有字符变为小写
    gUU  # 光标所在的行所有字符变为大写
    g~~  # 光标所在的行所有字符大小写反向转换

## 撤销，重复

### 撤销

    u            # 撤销 (undo)
    U            # 行撤销，撤销所有在前一个编辑行上的操作
    C-r          # 重做
    3 C-r        # 重做 3 次
    3 u          # 撤销 3 次
    .            # 重复最后一个命令
    22.          # 重复最后一个命令 22 次
    :undolist    # 查看撤消分支
    :undo        # 命令并指定编号做为参数，则能够撤销到某个分支。
    g-           # 返回较早的文本状态
    g+           # 返回较新的文本状态
    :earlier 10m # 命令退回到 10 分钟前的文本状态。
    :later 5s    # 命令跳转到 5 秒以后的编辑状态。命令参数中的"s"代表秒，"m"代表分钟，"h"代表小时。

## 录制命令

    qq  # 录制到 q
    ..  # 输入一系列复杂的指令
    q   # 再次按 q 停止录制
    @q  # 执行 q 中存储的指令
    @@  # 重复执行
    5@q # 表示重复执行宏 q 5 次

## 复制，粘贴

    y       # 抽出选择的文本到寄存器
    yy      # 复制当前行
    y$      # 复制光标位置到行尾
    y^      # 复制光标位置到行首
    yw      # 复制光标之后的单词剩余部分 (yank word)
    yb      # 复制光标之前的单词剩余部分
    yiw     # 复制一个单词
    yip     # 复制当前段落 (yank inner paragraph)
    yas     # 复制一个句子 (yank a sentence)
    yi<     # 复制尖括号之间的内容 (yank inner <>)
    p       # 将剪贴板中的内容粘贴在光标后（小写 p)
    P       # 将剪贴板中的内容粘贴在光标前（大写 p)
    yfa     # 表示拷贝从当前光标到光标后面的第一个 a 字符之间的内容。
    y2fa    # 表示拷贝从当前光标到光标后面的第二个 a 字符之间的内容。
    "ayy    # 复制当前行到寄存器'a'（可使用范围'a-z')
    "ap     # 粘贴从寄存器'a'
    "2p     # 粘贴 2 次
    :12,24y # 表示拷贝第 12 行到第 24 行之间的内容。
    :12,y   # 表示拷贝第 12 行到光标所在行之间的内容。
    :,24y   # 表示拷贝光标所在行到第 24 行之间的内容。删除类似。
    <C-r>"  # 粘贴（插入模式）

    寄存器
    :reg   # 查看所有寄存器中的内容
    ""     # 无名寄存器，最近一次删除 / 修改 / 替换操作的文本都会放入这个寄存器
    0-9    # 10 个数字寄存器，拷贝或者删除的文本存入这些寄存器，这些寄存器是循环使用的，在每次存入内容到寄存器 1 时，原有的内容会依次存入到后一个寄存器中。
    -      # 小删除寄存器，删除内容少于一行时放入这个寄存器。
    a-za-z # 26 个命名寄存器，大小写无关。这些寄存器可以在拷贝或者删除等操作中指定使用。
    :.%    # # 四个只读寄存器
    =      # 表达式寄存器
    /# +~  # 选择和拖放寄存器，用于与系统剪切板交互，以及接收拖放操作的内容。
    _      # 黑洞寄存器，放到这里面的内容都被丢弃，这样可以删除或拷贝时不影响其它寄存器。
    /      # 最后一次搜索模式寄存器，保存最后一次搜索的正则表达式。

## 缩进，对齐

### 缩进

    >>        # 缩进当前行
    <<        # 向左缩进当前行
    >         # 向右缩进选定的行（可视模式）
    <         # 向左缩进选定的行（可视模式）
    >}        # 向右缩进光标处到段落尾部
    >G        # 缩进到文件尾部
    >gg       # 缩进到文件顶部
    5>>       # 向下缩进 5 行
    5>k       # 向上缩进 5 行
    :3,9>>>>> # 将 3-9 行缩进 5 个 tab
    :12,24>   # 将 12 行到 14 行向右移动一个 tab
    :12,24>>  # 将 12 行到 14 行的数据都向右移动两个 tab
    :5,10>>   # 第 5-10 行向右缩进两个 tab
    :5,10<    # 第 5-10 行向左缩进一个 tab
    >i{       # 缩进花括号之间的内容 (indent inner {})（同'>ib')
    >a{       # 缩进花括号及之间的内容 (indent a {})（同'>ab')

### 对齐

    v         # （进入 visual 模式），选中部分行，然后按＝对齐到左边界
    =G        # 当前行到文件尾部对齐到左边界
    =5        # 向下 5 行对齐到左边界
    gg=G      # 全文对齐 / 格式化
    =}        # 对齐当前段落

## 查找，替换

    + 查找
      /[word]           # 向下搜索 [word] 字符串
      ?[word]           # 向上搜索 [word] 字符串
      n                 # 跳转到下一个匹配的字符串（相对于搜索命令的方向）
      N                 # 跳转到上一个匹配的字符串（相对于搜索命令的方向）
      /#                # 向前搜索光标所在单词
      /#                # 向后搜索光标所在单词

    + 替换
      # 局部替换
        :s/old/new        # 只替换当前行第一个匹配的字符串
        :s/old/new/g      # 替换当前行或选中行所有字符串
        :s/old/new/gc     # 替换前确认
        :13,18s/old/new/g # 替换 13 到 18 行的内容

      # 全局替换
        :%s/old/new/g      # 替换当前文件所有行
        :%s/old/new/gc     # 替换当前文件所有行（替换前确认）

      # 可视区域替换
        先选中要替换文字的范围
        :s/old/new/g

      # 确认替换
        如果把末尾的 g 改成 gc 在替换的时候，会有提示！推荐使用！
        :%s/旧文本/新文本/gc
        y - yes 替换
        n - no 不替换
        a - all 替换所有
        q - quit 退出替换
        l - last 最后一个，并把光标移动到行首
        ^E 向下滚屏
        ^Y 向上滚屏

------------------------------------------------------------------

    :%s/\s\+$#   去除行尾空白字符 ('\s'表示空白字符'空格 /tab'，'\+'表示一个或多个）
    :3s/w1/r2/g   将第 3 行到文件末尾所有的'w1'替换为'r2'
    :s/old/new/c       当前行 old 替换成 new ， 只替换当前行第一个匹配的字符串
    :s/old/new/gc      替换当前行所有
    :13,18s/old/new/gc 替换 13 到 18 行的内容
    :%s/old/new/gc     替换当前文件所有行前确认
    :g/hello/d         删除含有 hello 的行
    :g!/hello/d        删除不含 hello 的行
    :v/hello/d         与 :g! 同

    :%s/^\n#g         删除空行
    :%s/^ ##g         删除行首的空格
    :%s/ #$#g         删除行尾的空格
    :%s/^\n\{3}#      可以用以下命令删除三行空行：
    :%s/\n\n/\r/g      可以用以下命令将连续的两个空行替换成一个空行
    :0,$s/^/#/gc       在行首加一个#号
    :6,10s/^/#/gc      在 6~10 行的行首加一个#号
    :%s= #$==          将所有行尾多余的空格删除
    :g/^s#$/d          将所有不包含字符（空格也不包含）的空行删除。
    :s# 和：g#，:!g#
    这两个命名加上正则表达式，常常能完成非常复杂的编辑任务，可以毫不夸张地说是 vim 的两柄瑞士军刀。:s 是替换操作，:g 是查找匹配模式的行，:!g 是查找不匹配模式的行。

## 窗口操作

### 命令行窗口

    q:         # 正常模式下输入 q: 打开命令行窗口查看、执行输入过的命令。编辑新的命令或修改旧的命令。可以拷贝粘贴。
    :%s/ C-f p # 假定要将 123 替换成 456，现 yw 复制 123，然后在底行输入 :%s/ 这个时候输入 C-f, 会在当前窗口下面
                 出现一个小窗口用来编辑命令。在这个新窗口用 p 将 123 粘贴过来就可以了。剩下的命令要直接在这个新窗口完成。
    :C-r       # 命令窗口下粘贴。先在普通模式下用 y 复制。到命令行模式下 ctrl-r 然后“进行粘贴，可重复多次粘贴
    C-cc       # 关闭命令行窗口

### 新建窗口

    C-w n      # 新建一个缓冲区
    C-w v      # 左右切割窗口新建缓冲区
    C-w s      # 上下切割窗口新建缓冲区
    :sp        # 水平分割当前窗口 (split)
    :sp [file] # 水平分割一个新窗口，并编辑文件 [file]
    :vs        # 垂直分割当前窗口 (vertical split)
    :vs [file] # 垂直分割一个新窗口，并编辑文件 [file]
    :only      # 关闭其他窗口

### 关闭窗口

    C-w c  # 关闭当前窗口，与 q 的区别是不能退出最后一个窗口
    C-w q  # 退出当前窗口，如果剩最后一个窗口，则退出 vim
    C-w o  # 使光标所在缓冲区最大化，其他缓冲区隐藏，再次使用则恢复恢原貌

### 移动窗口

    C-w w   # 所有窗口循环移动
    C-w l   # 光标移到右边窗口
    C-w h   # 光标移到左边窗口
    C-w k   # 光标移到上边窗口
    C-w j   # 光标移到下边窗口
    C-w L   # 窗口移动到最右边
    C-w H   # 窗口移动到最左边
    C-w K   # 窗口移动到最上边
    C-w J   # 窗口移动到最下边
    C-w p   # 移动到前一个访问的窗口
    C-w r   # 向右或向下方交换窗口
    C-w R   # 向左或向上方交换窗口
    C-w x   # 交换同列或同行的窗口
    C-w t   # 移动到最左上角的窗口
    C-w b   # 移动到最右下角的窗口

### 调整窗口大小

    分屏窗口都是基于 CTRL + W 这个快捷键的，w 对应的英文单词是 window
    调整窗口宽高的命令可以和数字连用，例如：5 CTRL + W + 连续 5 次增加高度
    C-w +  # 增加窗口高度
    C-w -  # 减少窗口高度
    C-w >  # 增加窗口宽度
    C-w <  # 减少窗口宽度
    C-w =  # 等分窗口大小
    C-w |  # 最大宽度
    C-w 1  # 最小宽度

### 分割窗口模式打开文件

    vim  -o5 /a /b # 将分配 5 个相同的窗口，有 3 个是闲置的
    vim -o2        # 垂直分两个屏
    vim -o /a /b   # 垂直分屏打开两个文件
    vim -o /a /b   # 水平打开现个文件
    vim -d /a /b   # 垂直 diff 两个文件
    vim -do /a /b  # 垂直分屏比较两个文件

### 多文件操作

    vim 1.txt 2.txt 3.txt 同时打开多个文档
    :args 查看多文件状态，可以简写成 ar
    :next 切换下一个文件
    :prev 切换上一个
    :next! 切换下一个文件，并强制丢弃修改
    :prev! 切换上一个文件，并强制丢弃修改
    :first 首文件
    :last 尾文件
    C-^ 切换两个其它切换命令切换后的两个文件

### 标签操作

    :tabnew        # 标签命令 gt gt 进行标签切换

## 折叠

    zo  # 打开光标下的折叠 (open)
    zc  # 关闭光标下的折叠 (close)
    zr  # 打开所有的折叠
    zm  # 关闭所有的折叠

## 保存退出

:e .	edit	会打开内置的文件浏览器，浏览要当前目录下的文件
:n 文件名	new	新建文件
:w 文件名	write	另存为，但是仍然编辑当前文件，并不会切换文件
    :w              # 保存文件
    :w!             # 文件属性为『只读』时，强制写入该档案。不过，到底能不能写入， 还是跟你对该档案的权限有关
    :wa             # 保存所有文件
    :wq             # 强制性写入文件并退出。即使文件没有被修改也强制写入，并更新文件的修改时间。
    :wq!            # 强制保存文件并退出 vi
    :wqa            # 保存退出所有窗口
    :wqa!           # 强制保存退出所有窗口
    :q              # 不保存退出
    :q!             # 不保存强制退出
    :qa             # 退出所有窗口
    :qa!            # 强制退出所有文件
    :x              # 写入文件并退出。仅当文件被修改时才写入，并更新文件修改时间，否则不会更新文件修改时间。
    :X              # 保存并退出，同时清除加密信息
    ZZ              # 保存当前文件，然后退出！效果等同于 :wq
    ZQ              # 不保存，强制退出。效果等同于 :q!
    :w [file]       # 另存为 file 文件，不退出 vi
    :w! [file]      # 强制另存覆盖已有文件
    :e [file]       # 打开另一个文件
    :pwd            # 输出当前工作目录到状态栏
    :cd [dir]       # 切换当前工作目录到 [dir]
    :w > [file]     # 将当前文件内容写入 [file] 文件（文件不存在，同':saveas')
    :e [dir]        # 打开一个目录，以例表的形式展示文件 (vim7.0 后续版本 netrw.vim 插件来实现）
    :e!             # 重新载入当前文件，放弃所有的修改，从上次保存文件开始再编辑
    :e! [file]      # 不保存当前的文件，强制打开新文件
    :r [file]       # 读入另一个文件，将 [file] 文件内容插入到下一行 (read)
    :r !command     # 读取 shell 命令输出结果
    :3,9w >> [file] # 将 3-9 行的内容追加到 [file] 文件末尾（文件已存在）
    :n,mw [file]    # 将第 n-m 行的文本保存到指定的文件 filename 中。
    :m,nw >> <file> # 将 m 行到 n 行的内容添加到文件 <file> 的末尾

## 块操作

    v   # 进入可视模式，以字符为单位选择
    V   # 进入可视模式，以行为单位选择
    C-v # 进入列块可视模式
    gv  # 重新选择最后选定的区域
    v(  # 选中一个句字
    v{  # 选中一个段落

  ##块替换##

    源始状态：
    chwin ch
    chwin ch
    chwin ch
    ctrl-v 进入块选择模式，只选择 chwin 部分，按 c/d/r 键后输入要批量更改的字符串，然后按 esc 键批量更改如下：
    win ch
    win ch
    win ch
    win ch

## 缓冲区

    :ls             查看缓冲区列表
    :bn             编辑下一个缓冲区 (buffer next)
    :bp             编辑上一个缓冲区 (buffer previous)
    :b[n]           编辑缓冲区列表中第 [n] 个缓冲区
    :b a.txt        编辑缓冲区列表中 a.txt 缓冲区
    :bd             卸载当前缓冲区 (buffer delete)
    :bn             跳转到下一个 buffer
    :bp             跳转到上一个 buffer
    :wn             存盘当前文件并跳转到下一个（又是“超级……”,ft!)
    :wp             存盘当前文件并跳转到上一个
    :bd             把这个文件从 buffer 列表中做掉
    :bun            卸掉 buffer （关闭这个 buffer 的窗口但是不把它从列表中做掉）
    :badd file.c    把文件 file.c 添加到 buffer 列表
    :b 3            跳到第 3 个 buffer
    :b main         跳到一个名字中包含 main 的 buffer, 例如 main.c               : (ultra，这个怎么翻译？:()
    :sav php.html   把当前文件存为 php.html 并打开 php.html
    :sav! %<.bak    换一个后缀保存

## 常用命令

    set nu   # 打开行号
    set rnu  # 打开相对行号
    set nonu # 关闭行号
